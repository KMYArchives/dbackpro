"use strict";var CreateBackup={_checked_option:function(t){return!!El.checked("#backup-"+t)},_insertDB:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];DBX.insert(t).into("backups").then(function(t){BackupModal.hide(),ListBackups.page_load(),CreateBackupLogs.insert({type:"success",show_msg:e,query:"create_backup",database:Storage.get("dbSelected"),message:"Backup generated with successfully",conn_id:JSON.parse(Storage.get("connData")).slug})})},create:function(){var e=this,a=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n=El.value("#backup-path")+"/",o=n+datetime.create().format("YmdHmS")+".sql";mysqldump({dump:{data:{verbose:this._checked_option("verbose"),format:this._checked_option("formatData"),lockTables:this._checked_option("lockTables"),includeViewData:this._checked_option("viewData"),returnFromFunction:this._checked_option("returnFromFunction"),maxRowsPerInsertStatement:El.value("#backup-maxRowsPerInsert")},schema:{engine:this._checked_option("schemaEngine"),format:this._checked_option("schemaFormat"),autoIncrement:this._checked_option("schemaAutoIncrement"),view:{definer:this._checked_option("viewDefiner"),algorithm:this._checked_option("viewAlgorithm"),sqlSecurity:this._checked_option("viewSqlSecurity"),createOrReplace:this._checked_option("viewCreateOrReplace")},table:{charset:this._checked_option("charset"),ifNotExist:this._checked_option("ifNotExist"),dropIfExist:this._checked_option("dropIfExist")}},trigger:{delimiter:El.value("#backup-triggerDelimiter"),definer:this._checked_option("triggerDefiner"),dropIfExist:this._checked_option("triggerDropIfExist")}},connection:{database:Storage.get("dbSelected"),host:JSON.parse(Storage.get("connData")).host,user:JSON.parse(Storage.get("connData")).user,password:JSON.parse(Storage.get("connData")).password},dumpToFile:o}).then(function(t){e._insertDB({path:n,slug:Slug.range(36,48),db:Storage.get("dbSelected"),size:fs.statSync(o).size,name:Find.replace(o,n,""),dropIfExists:e._checked_option("dropIfExist"),added_in:datetime.create().format("Y-m-d H:m:S"),conn_id:JSON.parse(Storage.get("connData")).slug,driver:JSON.parse(Storage.get("connData")).driver},a)})}},DeleteBackup={_delete_file:function(){DBX.select("path","name").from("backups").where({slug:Storage.get("backupID")}).then(function(t){File.unlink(t[0].path+t[0].name)})},delete:function(){this._delete_file(),DBX.delete().from("backups").where({slug:Storage.get("backupID")}).then(function(t){ListBackups.list(),ListBackups.total(),CreateBackupLogs.insert({type:"success",show_msg:!1,query:"delete_backup",database:Storage.get("dbSelected"),message:"Backup deleted with successfully",conn_id:JSON.parse(Storage.get("connData")).slug}),ConfirmModal.hide(),Storage.delete("backupID")})},confirm:function(t){Storage.set("backupID",t),ConfirmModalBackup.delete()}},ListBackups={list:function(){var e=this;El.empty(el_list_content),DBX.select(["slug","name","path","driver","size","added_in"]).where({db:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}).from("backups").then(function(t){0<t.length?_.forEach(_.orderBy(t,"added_in","asc"),function(t){e.item_layout(t)}):El.append(el_list_content,'\n\t\t\t\t\t<div class="zero">No backup\'s</div>\n\t\t\t\t')})},total:function(){DBX.count("*").where({db:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}).from("backups").then(function(t){topbar_loader.total("".concat(t[0]["count(*)"]," item's"))})},sidebar:function(){sidebar_loader.clean(),sidebar_loader.set([{id:"list-tables",title:"Back to tables",icon:"fas fa-arrow-left",click:"MySQL_ListTables.page_load()"},{actived:!0,id:"list-local",icon:"fas fa-desktop",title:"List local backup's",click:"ListBackups.page_load()"},{id:"list-cloud",icon:"fas fa-cloud",title:"List cloud backups",click:"Hello.world()"}])},page_load:function(){this.list(),this.total(),this.sidebar(),Storage.delete("backupID")},item_layout:function(t){El.append(el_list_content,'\n\t\t\t<div class="item">\n\t\t\t\t<div class="icon">\n\t\t\t\t\t<div class="fas fa-file"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="field1">'.concat(t.added_in,'</div>\n\t\t\t\t<div class="field2">').concat(Str.cut(t.path,30),'</div>\n\t\t\t\t<div class="field3">').concat(t.driver,'</div>\n\t\t\t\t<div class="field4">').concat(Format.bytes(t.size),'</div>\n\n\t\t\t\t<div class="menu">\n\t\t\t\t\t<div class="fas fa-arrow-rotate-right" onclick="RestoreBackup.confirm(\'').concat(t.slug,'\')"></div>\n\t\t\t\t\t<div class="fas fa-trash-alt" onclick="DeleteBackup.confirm(\'').concat(t.slug,"')\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"))}},RestoreBackup={_restore:function(t){"mysql2"===t.driver&&this._mysql_restore(t.file)},_mysql_restore:function(t){(new MysqlTools).restoreDatabase({sqlFilePath:t,database:Storage.get("dbSelected"),host:JSON.parse(Storage.get("connData")).host,port:JSON.parse(Storage.get("connData")).port,user:JSON.parse(Storage.get("connData")).user,password:JSON.parse(Storage.get("connData")).password},function(t,e,a){ConfirmModal.hide(),t instanceof Error?CreateBackupLogs.insert({type:"error",show_msg:!0,message:t,query:"restore_backup",database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}):(MySQL_ListTables.page_load(),CreateBackupLogs.insert({show_msg:!0,type:"success",message:a,query:"restore_backup",database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}))})},restore:function(){var a=this;DBX.select("driver","path","name").from("backups").where({slug:Storage.get("backupID")}).then(function(t){var e=t[0].path+t[0].name;a._restore({file:e,driver:t[0].driver})})},confirm:function(t){Storage.set("backupID",t),ConfirmModalBackup.restore()}},DBX=knex({client:"sqlite",connection:{filename:Core.get_file("app","dbackpro.db")},useNullAsDefault:!0}),RealTime={tasks:function(){setInterval(function(t){Gravatar.auto_download(),ListConnections.auto_refresh_list()},1e3)}},CreateDiagram={save:function(){},create:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=(El.empty(".diagram"),El.append(".diagram","<div class='tbl-item'></div>"),Storage.get("tblSelected")?Storage.get("tblSelected"):t);El.empty(".tbl-item"),El.append(".tbl-item","\n\t\t\t<div class='tbl-name'>\n\t\t\t\t".concat(t,"\n\t\t\t</div>\n\t\t")),GetConnection.create_conn().raw("SHOW FULL COLUMNS FROM ".concat(Storage.get("dbSelected"),".").concat(t)).then(function(t){_.forEach(t,function(t){_.forEach(t,function(t){var e;null!=t.Field&&(e="","PRI"!=t.Key&&"UNI"!=t.Key||(e="<div class='fas fa-key ".concat(t.Key,"'></div>")),El.append(".tbl-item","\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t".concat(e,"\n\t\t\t\t\t\t\t\t").concat(t.Field,": ").concat(t.Type,"\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t")))})})})}},DeleteDiagram={},GetDiagram={},ListDiagrams={},UploadDiagram={},CreateBackupLogs={_slug:function(t){return Slug.custom({length:t,charset:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"})},insert:function(a){var e=this;DBX.select("*").where({name:"system.backupLogs"}).from("configs").then(function(t){"1"==t[0].value&&DBX.insert({type:a.type,query:a.query,conn_id:a.conn_id,table:a.table||null,message:a.message||null,user_id:a.user_id||null,database:a.database||null,sql_query:a.sql_query||null,added_in:datetime.create().format("Y-m-d H:m:S"),slug:a.slug||e._slug([36,48])}).into("logs").then(function(t){var e=el_msg_return;null!=a.show_msg_el&&(e=a.show_msg_el),1==a.show_msg&&GUI.message(e,a.message)})})}},DeleteBackupLogs={},ListBackupLogs={},menubox_loader=new MenuBox(el_menu_actions),CloneModal={show:function(){menubox_loader.hide(),El.value("#clone-tbl-name",Storage.get("tblSelected")),El.show(el_mask_mdl),El.show(el_clone_mdl)},hide:function(){El.hide(el_mask_mdl),El.hide(el_clone_mdl)},layout:function(){El.empty(el_clone_mdl),El.append(el_clone_mdl,'\n\t\t\t<div class=\'mdl-title\'>\n\t\t\t\t<div class=\'label\'>Clone table</div>\n\t\t\t\t<div class=\'fas fa-times\' onclick=\'CloneModal.hide()\'></div>\n\t\t\t</div>\n\n\t\t\t<div class="legend">Table name</div>\n\t\t\t<input type="text" id="clone-tbl-name" placeholder="Table name">\n\n\t\t\t<div class="legend">Select a database</div>\n\t\t\t<select id="clone-db-name"></select>\n\n\t\t\t<div class="legend">Type</div>\n\t\t\t<select id="clone-options">\n\t\t\t\t<option value="data">Data only</option>\n\t\t\t\t<option value="structure">Structure only</option>\n\t\t\t\t<option value="data-structure" selected>Data and structure</option>\n\t\t\t</select>\n\n\t\t\t<button class="bblr" onclick="CloneModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="CloneTable.clone()">Confirm</button>\n\t\t')}},CodeModal={show:function(){El.show(el_mask_mdl),El.show(el_code_mdl)},hide:function(){El.hide(el_mask_mdl),El.hide(el_code_mdl)},layout:function(){""==El.html(el_code_mdl)&&(El.append(el_code_mdl,"\n\t\t\t\t<div class='mdl-title'>\n\t\t\t\t\t<div class='label' id='code-tbl-name'></div>\n\n\t\t\t\t\t<div class='fas fa-times' onclick='CodeModal.hide()'></div>\n\t\t\t\t\t<div class='fas fa-cog' onclick='Hello.world()'></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='mdl-bar' id='code-tbl-bar'>\n\t\t\t\t\t<div class='item' id='code-tbl-share' onclick='Hello.world()'>Share</div>\n\t\t\t\t\t<div class='item' id='code-tbl-send' onclick='Hello.world()'>Send to</div>\n\n\t\t\t\t\t<div class='right'>\n\t\t\t\t\t\t<div class='message' id='code-tbl-msg'></div>\n\n\t\t\t\t\t\t<div class='icon' id='smd-list' onclick='SMDList.toggle()'>\n\t\t\t\t\t\t\t<div class='fas fa-book'></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='icon' id='code-tbl-save' onclick='CreateSnippets.create()'>\n\t\t\t\t\t\t\t<div class='fas fa-floppy-disk'></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='shot-link' id='".concat(Find.replace(ShotLink.el_main,"#",""),"'>\n\t\t\t\t\t<img id='").concat(Find.replace(ShotLink.el_main_img,"#",""),"'>\n\n\t\t\t\t\t<div class='bottom' id='").concat(Find.replace(ShotLink.el_main_bottom,"#",""),"'>\n\t\t\t\t\t\t<a class='hostname'></a>\n\t\t\t\t\t\t<div class='fas fa-info-circle'></div>\n\t\t\t\t\t\t<div class='fas fa-shield'></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='smd-list' id='").concat(Find.replace(SMD.el_list_main,"#",""),"'></div>\n\t\t\t\t<div class='smd-get' id='").concat(Find.replace(SMD.el_main,"#",""),"'></div>\n\t\t\t\t<div class='smd-get' id='").concat(Find.replace(SMD.el_main_dataset,"#",""),"'></div>\n\n\t\t\t\t<textarea id='").concat(Find.replace(el_editor,"#",""),"'></textarea>\n\t\t\t")),SMD.load_get(),SMD.load_list(),SMD.load_get_dataset(),EditorAutoload.loader())},show_save:function(){El.show("#code-tbl-save")},hide_save:function(){El.hide("#code-tbl-save")},title:function(t){El.text("#code-tbl-name",t)}},DiagramModel={show:function(){El.text("#diagram-tbl-name",Storage.get("tblSelected")),El.show(el_mask_mdl),El.show(el_diagram_mdl)},hide:function(){El.hide(el_mask_mdl),El.hide(el_diagram_mdl)},layout:function(){El.empty(el_diagram_mdl),El.append(el_diagram_mdl,"\n\t\t\t<div class='mdl-title'>\n\t\t\t\t<div class='label' id='diagram-tbl-name'></div>\n\t\t\t\t<div class='fas fa-times' onclick='DiagramModel.hide()'></div>\n\t\t\t</div>\n\n\t\t\t<div class='mdl-bar' id='diagram-tbl-bar'>\n\t\t\t\t<div class='item' id='diagram-tbl-share' onclick='Hello.world()'>Share</div>\n\t\t\t\t<div class='item' id='diagram-tbl-send' onclick='Hello.world()'>Send to</div>\n\n\t\t\t\t<div class='right'>\n\t\t\t\t\t<div class='message' id='diagram-tbl-msg'>Saved with successfully.</div>\n\n\t\t\t\t\t<div class='icon' id='diagram-tbl-save' onclick='Hello.world()'>\n\t\t\t\t\t\t<div class='fas fa-floppy-disk'></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class='diagram'></div>\n\t\t")}},NotifyBox={},CreateSnippets={_insert:function(){DBX.insert({slug:this._slug([36,48]),name:Storage.get("tblSelected"),database:Storage.get("dbSelected"),sql_code:EditorAutoload.getValue(),added_in:datetime.create().format("Y-m-d H:m:S"),conn_id:JSON.parse(Storage.get("connData")).slug}).into("snippets").then(function(t){CreateBackupLogs.insert({show_msg:!0,type:"success",query:"create_snippet",show_msg_el:"#code-tbl-msg",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),message:"Snippet saved with success",conn_id:JSON.parse(Storage.get("connData")).slug})})},_update:function(){DBX.update({sql_code:EditorAutoload.getValue(),updated_in:datetime.create().format("Y-m-d H:m:S")}).table("snippets").where({name:Storage.get("tblSelected"),database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}).then(function(t){CreateBackupLogs.insert({show_msg:!0,type:"success",query:"edited_snippet",show_msg_el:"#code-tbl-msg",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),message:"Snippet updated with success",conn_id:JSON.parse(Storage.get("connData")).slug})})},_slug:function(t){return Slug.custom({length:t,charset:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"})},create:function(){var e=this;DBX.select("*").from("snippets").where({name:Storage.get("tblSelected"),database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}).then(function(t){0==t.length?e._insert():e._update()})}},DeleteSnippet={delete:function(){DBX.delete().from("snippets").where({slug:Storage.get("snippetID")}).then(function(t){ListSnippets.list(),ListSnippets.total(),CreateBackupLogs.insert({type:"success",show_msg:!1,query:"delete_snippet",message:"Snippet deleted with successfully",conn_id:JSON.parse(Storage.get("connData")).slug}),ConfirmModal.hide(),Storage.delete("snippetID")})},confirm:function(t){Storage.set("snippetID",t),ConfirmModalSnippet.delete()}},GetSnippet={get:function(t){DBX.select(["slug","name","database","sql_code","added_in"]).where({slug:t}).from("snippets").then(function(t){CreateBackupLogs.insert({show_msg:!1,type:"success",query:"get_snippet",conn_id:JSON.parse(Storage.get("connData")).slug,message:"Get snippet ".concat(t[0].database,".").concat(t[0].name)}),CodeModal.title(t[0].name),EditorAutoload.setValue(t[0].sql_code),CodeModal.show(),CodeModal.hide_save()})}},ListSnippets={list:function(){var e=this;topbar_loader.clean(),El.empty(el_list_content),DBX.select(["slug","name","database","added_in"]).from("snippets").then(function(t){0<t.length?t.forEach(function(t){e.item_layout(t)}):El.append(el_list_content,'\n\t\t\t\t\t<div class="zero">No snippet\'s</div>\n\t\t\t\t')})},total:function(){DBX.count("*").from("snippets").then(function(t){topbar_loader.total("".concat(t[0]["count(*)"]," item's"))})},sidebar:function(){sidebar_loader.clean(),sidebar_loader.set([{id:"list-databases",icon:"fas fa-arrow-left",title:"Back to databases",click:"MySQL_ListDatabases.page_load()"},{actived:!0,icon:"fas fa-desktop",id:"list-snippet-desktop",title:"List local snippets",click:"ListSnippets.page_load()"},{icon:"fas fa-cloud",id:"list-snippet-cloud",title:"List cloud snippets",click:"Hello.world()"}])},top_bar:function(){this.total(),topbar_loader.clean(),topbar_loader.title("Snippets")},page_load:function(){this.list(),this.top_bar(),this.sidebar(),Storage.delete("snippetSelected")},item_layout:function(t){El.append(el_list_content,'\n\t\t\t<div class="item">\n\t\t\t\t<div onclick="GetSnippet.get(\''.concat(t.slug,'\')">\n\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t<div class="fas fa-code"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="field1">').concat(Str.cut(t.name,40),'</div>\n\t\t\t\t\t<div class="field2">').concat(Str.cut(t.database,24),'</div>\n\t\t\t\t\t<div class="field3">').concat(t.added_in,'</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="menu">\n\t\t\t\t\t<div class="fas fa-cloud-arrow-up" onclick="Hello.world(\'').concat(t.slug,'\')"></div>\n\t\t\t\t\t<div class="fas fa-trash-alt" onclick="DeleteSnippet.confirm(\'').concat(t.slug,"')\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"))}},Profile={_toggle_exit_icon:function(){Storage.has("userData")?El.show("#exit-icon"):El.hide("#exit-icon")},menu:function(){El.append(el_menu_app,"\n\t\t\t<div class='header'>\n\t\t\t\t<img alt=''>\n\t\t\t\t<div class='name' onclick='Login.open()'></div>\n\n\t\t\t\t<div class='right'>\n\t\t\t\t\t<div class='fas fa-arrow-right-from-bracket' id='exit-icon' title='Logoff' onclick='Login.logoff()'></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class='list'>\n\t\t\t\t<div class='item'>Setting's</div>\n\t\t\t\t<div class='item'>My cloud</div>\n\t\t\t\t<div class='item'>My account</div>\n\t\t\t\t<div class='item'>Help & Support</div>\n\t\t\t</div>\n\t\t")},set_name_avatar:function(){var t;Storage.has("userData")?(t=JSON.parse(Storage.get("userData")),El.text(el_menu_app+" > .header > .name",t.name)):El.text(el_menu_app+" > .header > .name","Connect your account"),Attr.set(el_menu_app+" > .header > img","src",Gravatar.get()),this._toggle_exit_icon()}},ApplyFiltersBackupLogs={},FiltersBackupLogs={_logs_queries:function(){return{error_connection:"Connection Error",optimize_table:"Optimize Table",check_table:"Check Table",rename_table:"Rename Table",analyze_table:"Analyze Table",drop_table:"Drop Table",truncate_table:"Truncate Table",show_create:"Table Code",create_backup:"Create Backup",restore_backup:"Restore Backup",delete_backup:"Delete Backup",create_snippet:"Create Snippet",get_snippet:"Get Snippet",edited_snippet:"Update Snippet",delete_snippet:"Delete Snippet",create_diagram:"Create Diagram",delete_diagram:"Delete Diagram"}},types:function(){DBX.select(["type"]).from("logs").groupBy("type").then(function(t){_.forEach(t,function(t){null!=t.type&&console.log(Str.capitalize(t.type))})})},tables:function(){DBX.select(["table"]).from("logs").groupBy("table").then(function(t){_.forEach(t,function(t){null!=t.table&&console.log(t.table)})})},queries:function(){var e=this;DBX.select(["query"]).from("logs").groupBy("query").then(function(t){_.forEach(t,function(t){console.log(t.query,e._logs_queries()[t.query])})})},databases:function(){DBX.select(["database"]).from("logs").groupBy("database").then(function(t){_.forEach(t,function(t){null!=t.database&&console.log(t.database)})})}},BackupModalProperties={choose_folder:function(){dialog({type:"directory"}).then(function(t){El.value("#backup-path",t[0])})},tab_group_data:function(){El.show("#backup-group-data"),Classes.add("#tab-group-data",act_class),El.hide(["#backup-group-schema","#backup-group-view","#backup-group-table","#backup-group-trigger"]),Classes.remove(["#tab-group-schema","#tab-group-view","#tab-group-table","#tab-group-trigger"],act_class)},tab_group_view:function(){El.show("#backup-group-view"),Classes.add("#tab-group-view",act_class),El.hide(["#backup-group-schema","#backup-group-data","#backup-group-table","#backup-group-trigger"]),Classes.remove(["#tab-group-schema","#tab-group-data","#tab-group-table","#tab-group-trigger"],act_class)},tab_group_table:function(){El.show("#backup-group-table"),Classes.add("#tab-group-table",act_class),El.hide(["#backup-group-schema","#backup-group-view","#backup-group-data","#backup-group-trigger"]),Classes.remove(["#tab-group-schema","#tab-group-view","#tab-group-data","#tab-group-trigger"],act_class)},tab_group_schema:function(){El.show("#backup-group-schema"),Classes.add("#tab-group-schema",act_class),El.hide(["#backup-group-data","#backup-group-view","#backup-group-table","#backup-group-trigger"]),Classes.remove(["#tab-group-data","#tab-group-view","#tab-group-table","#tab-group-trigger"],act_class)},tab_group_trigger:function(){El.show("#backup-group-trigger"),Classes.add("#tab-group-trigger",act_class),El.hide(["#backup-group-schema","#backup-group-view","#backup-group-table","#backup-group-data"]),Classes.remove(["#tab-group-schema","#tab-group-view","#tab-group-table","#tab-group-data"],act_class)},toggle_dump_settings:function(){El.toggle(".dump-settings"),Classes.toggle(".dump-settings-toggle",act_class),this.tab_group_data()}},menubox_loader=new MenuBox(el_menu_actions),BackupModal={show:function(){El.show(el_mask_mdl),El.show(el_backup_mdl)},hide:function(){El.hide(el_mask_mdl),El.hide(el_backup_mdl)},layout:function(){El.empty(el_backup_mdl),El.append(el_backup_mdl,"\n\t\t\t<div class='mdl-title'>\n\t\t\t\t<div class='label'>Create backup</div>\n\t\t\t\t<div class='fas fa-times' onclick='BackupModal.hide()'></div>\n\t\t\t</div>\n\n\t\t\t<div class='body'>\n\t\t\t\t<div class='legend'>Store</div>\n\t\t\t\t<select id='backup-store'>\n\t\t\t\t\t<option value='local'>Local</option>\n\t\t\t\t\t<option value='dbp-cloud'>DBack Pro Cloud</option>\n\t\t\t\t</select>\n\n\t\t\t\t<div class='legend'>\n\t\t\t\t\tPath\n\t\t\t\t\t<div class='fas fa-folder-open' onclick='BackupModalProperties.choose_folder()'></div>\n\t\t\t\t</div>\n\n\t\t\t\t<input class='bdr-bot' type='text' id='backup-path' placeholder='Path of dump file' value='".concat(Find.replace_all(Core.get_path("app/dumps"),"\\","/"),"'>\n\n\t\t\t\t<div class='dump-settings-toggle' onclick='BackupModalProperties.toggle_dump_settings()'>\n\t\t\t\t\tAdvanced setting's\n\t\t\t\t\t<div class='fas fa-wrench'></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class='dump-settings'>\n\t\t\t\t\t<div class='tabs'>\n\t\t\t\t\t\t<div class='tab ").concat(act_class,"' id='tab-group-data' onclick='BackupModalProperties.tab_group_data()'>Data</div>\n\t\t\t\t\t\t<div class='tab' id='tab-group-schema' onclick='BackupModalProperties.tab_group_schema()'>Schema</div>\n\t\t\t\t\t\t<div class='tab' id='tab-group-view' onclick='BackupModalProperties.tab_group_view()'>View</div>\n\t\t\t\t\t\t<div class='tab' id='tab-group-table' onclick='BackupModalProperties.tab_group_table()'>Table</div>\n\t\t\t\t\t\t<div class='tab' id='tab-group-trigger' onclick='BackupModalProperties.tab_group_trigger()'>Trigger</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='tab-content' id='backup-group-data'>\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-verbose' checked>\n\t\t\t\t\t\t\t<label for='backup-verbose'>Verbose</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-lockTables' checked>\n\t\t\t\t\t\t\t<label for='backup-lockTables'>Lock Tables</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-formatData'>\n\t\t\t\t\t\t\t<label for='backup-formatData'>Format data</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-viewData'>\n\t\t\t\t\t\t\t<label for='backup-viewData'>Include view data</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-returnFromFunction'>\n\t\t\t\t\t\t\t<label for='backup-returnFromFunction'>Return from Function</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='legend'>Max rows per insert</div>\n\t\t\t\t\t\t<input type='number' id='backup-maxRowsPerInsert' min='1' max='999999' value='1'>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='tab-content' id='backup-group-schema'>\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-schemaEngine' checked>\n\t\t\t\t\t\t\t<label for='backup-schemaEngine'>Engine</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-schemaFormat' checked>\n\t\t\t\t\t\t\t<label for='backup-schemaFormat'>Format</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-schemaAutoIncrement' checked>\n\t\t\t\t\t\t\t<label for='backup-schemaAutoIncrement'>Auto Increment</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='tab-content' id='backup-group-view'>\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-viewDefiner'>\n\t\t\t\t\t\t\t<label for='backup-viewDefiner'>Definer</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-viewAlgorithm'>\n\t\t\t\t\t\t\t<label for='backup-viewAlgorithm'>Algorithm</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-viewSqlSecurity'>\n\t\t\t\t\t\t\t<label for='backup-viewSqlSecurity'>Sql Security</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-viewCreateOrReplace' checked>\n\t\t\t\t\t\t\t<label for='backup-viewCreateOrReplace'>Create Or Replace</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='tab-content' id='backup-group-table'>\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-charset' checked>\n\t\t\t\t\t\t\t<label for='backup-charset'>Include charset</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-ifNotExist' checked>\n\t\t\t\t\t\t\t<label for='backup-ifNotExist'>Include If Not Exist</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-dropIfExist' checked>\n\t\t\t\t\t\t\t<label for='backup-dropIfExist'>Include Drop if Exist</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class='tab-content' id='backup-group-trigger'>\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-triggerDefiner'>\n\t\t\t\t\t\t\t<label for='backup-triggerDefiner'>Definer</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='checkbox'>\n\t\t\t\t\t\t\t<input type='checkbox' id='backup-triggerDropIfExist' checked>\n\t\t\t\t\t\t\t<label for='backup-triggerDropIfExist'>Drop If Exist</label>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class='legend'>Delimiter</div>\n\t\t\t\t\t\t<input type='text' id='backup-triggerDelimiter' value=';;'>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<button class='bblr' onclick='BackupModal.hide()'>Cancel</button>\n\t\t\t<button class='bbrr' onclick='CreateBackup.create()'>Confirm</button>\n\t\t"))}},ConfirmModalBackup={delete:function(){El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Confirm delete backup ?</div>\n\t\t\t\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="DeleteBackup.delete()">Confirm</button>\n\t\t'),ConfirmModal.show()},restore:function(){El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Confirm restore backup ?</div>\n\t\t\t<div class="legend">This method use mysqldump cli, add mysql/bin folder in system PATH variable</div>\n\t\t\t\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="RestoreBackup.restore()">Confirm</button>\n\t\t'),ConfirmModal.show()}},ConfirmModalConns={clear:function(){El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Confirm delete all connection\'s ?</div>\n\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="DeleteConnections.clear()">Confirm</button>\n\t\t'),ConfirmModal.show()},delete:function(t){El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Confirm delete connection ?</div>\n\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="DeleteConnections.delete(\''.concat(t,"')\">Confirm</button>\n\t\t")),ConfirmModal.show()}},ConfirmModalSnippet={delete:function(){El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Confirm delete snippet ?</div>\n\t\t\t\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="DeleteSnippet.delete()">Confirm</button>\n\t\t'),ConfirmModal.show()}},menubox_loader=new MenuBox(el_menu_actions),ConfirmModalTable={drop_table:function(){menubox_loader.hide(),El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Confirm drop table ?</div>\n\t\t\t\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="MySQL_TableProperties.drop()">Confirm</button>\n\t\t'),ConfirmModal.show()},rename_table:function(){menubox_loader.hide(),El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Rename table</div>\n\t\t\t<input type="text" id="rename-input-modal" placeholder="Type the new table name">\n\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="MySQL_TableProperties.rename()">Confirm</button>\n\t\t'),ConfirmModal.show(),El.focus("#rename-input-modal"),El.value("#rename-input-modal",Storage.get("tblSelected"))},truncate_table:function(){menubox_loader.hide(),El.empty(el_confirm_modal),El.append(el_confirm_modal,'\n\t\t\t<div class="label">Confirm truncate the table ?</div>\n\n\t\t\t<button class="bblr" onclick="ConfirmModal.hide()">Cancel</button>\n\t\t\t<button class="bbrr" onclick="MySQL_TableProperties.truncate()">Confirm</button>\n\t\t'),ConfirmModal.show()}},ConfirmModal={show:function(){El.show(el_mask_mdl),El.show(el_confirm_modal)},hide:function(){El.hide(el_mask_mdl),El.hide(el_confirm_modal)}},DeleteConnections={clear:function(){DBX.truncate().from("conns").then(function(t){Storage.set(store_force_update,"list-conns")})},delete:function(t){DBX.delete().from("conns").where({slug:t}).then(function(t){Storage.set(store_force_update,"list-conns")})}},GetConnection={get:function(){Storage.has("editConnID")&&DBX.select("*").from("conns").where({slug:Storage.get("editConnID")}).then(function(t){El.value("#conn-name",t[0].name),El.value("#conn-host",t[0].host),El.value("#conn-port",t[0].port),El.value("#conn-user",t[0].user),El.value("#conn-driver",t[0].driver),El.value("#conn-pass",t[0].password),El.value("#conn-timeout",t[0].timeout)})},connect:function(t){DBX.select("*").from("conns").where({slug:t}).then(function(t){Storage.set("connData",JSON.stringify({slug:t[0].slug,name:t[0].name,host:t[0].host,user:t[0].user,port:t[0].port,driver:t[0].driver,password:t[0].password})),MySQL_ListDatabases.page_load()})},create_conn:function(){return knex({client:JSON.parse(Storage.get("connData")).driver,connection:{multipleStatements:!0,host:JSON.parse(Storage.get("connData")).host,port:JSON.parse(Storage.get("connData")).port,user:JSON.parse(Storage.get("connData")).user,password:JSON.parse(Storage.get("connData")).password}})},test_connect:function(t){(mysql_test_conn=knex({client:t.client,connection:{port:t.port,user:t.user,host:t.host,password:t.password}})).raw("SELECT count(*) FROM information_schema.tables GROUP BY table_schema ORDER BY table_schema ASC").then(function(t){0<t.length?console.log("connected"):console.log("error")})}},topbar_loader=new TopBar(el_topbar),sidebar_loader=new SideBar(el_sidebar),ListConnections={list:function(){var e=this;topbar_loader.clean(),El.empty(el_list_content),top_bar.title("Connection's"),DBX.select(["slug","name","host","user","port"]).from("conns").then(function(t){0<t.length?t.forEach(function(t){e.item_layout(t)}):El.append(el_list_content,'\n\t\t\t\t\t<div class="zero">No connection\'s</div>\n\t\t\t\t')})},total:function(){DBX.count("*").from("conns").then(function(t){topbar_loader.total("".concat(t[0]["count(*)"]," item's"))})},sidebar:function(){sidebar_loader.clean(),sidebar_loader.set([{id:"create-conn",icon:"fas fa-plus",title:"Create connection",click:"ManagerConnections.open()"},{id:"delete-conn",icon:"fas fa-trash-alt",title:"Delete all connections",click:"ConfirmModalConns.clear()"}])},top_bar:function(){this.total(),topbar_loader.clean(),topbar_loader.title("Connections")},page_load:function(){this.list(),this.top_bar(),this.sidebar(),El.hide(el_backup_logs_btn),Storage.delete("connData")},item_layout:function(t){El.append(el_list_content,'\n\t\t\t<div class="item">\n\t\t\t\t<div onclick="GetConnection.connect(\''.concat(t.slug,'\')">\n\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t<div class="fas fa-server"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="field1">').concat(Str.cut(t.name,40),'</div>\n\t\t\t\t\t<div class="field2">').concat(Str.cut(t.host,24),'</div>\n\t\t\t\t\t<div class="field3">').concat(Str.cut(t.user,24),'</div>\n\t\t\t\t\t<div class="field4">').concat(t.port,'</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="menu">\n\t\t\t\t\t<div class="fas fa-pen" onclick="ManagerConnections.get(\'').concat(t.slug,'\')"></div>\n\t\t\t\t\t<div class="fas fa-trash-alt" onclick="ConfirmModalConns.delete(\'').concat(t.slug,"')\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"))},auto_refresh_list:function(){Storage.has(store_force_update)&&"list-conns"==Storage.get(store_force_update)&&(this.list(),this.total(),Storage.delete(store_force_update))}},ManagerConnections={open:function(){Windows.load_custom({width:360,height:420,parent:"main",url:"pages/new-conn.html"})},create:function(){DBX.insert({slug:Slug.custom({length:[36,48],charset:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}),name:El.value("#conn-name"),host:El.value("#conn-host"),port:El.value("#conn-port"),user:El.value("#conn-user"),driver:El.value("#conn-driver"),password:El.value("#conn-pass"),timeout:El.value("#conn-timeout"),added_in:datetime.create().format("Y-m-d H:m:S")}).into("conns").then(function(t){Storage.set(store_force_update,"list-conns"),Windows.custom_close()})},update:function(){DBX.update({name:El.value("#conn-name"),host:El.value("#conn-host"),port:El.value("#conn-port"),user:El.value("#conn-user"),driver:El.value("#conn-driver"),password:El.value("#conn-pass"),timeout:El.value("#conn-timeout")}).table("conns").where({slug:Storage.get("editConnID")}).then(function(t){Storage.delete("editConnID"),Storage.set(store_force_update,"list-conns"),Windows.custom_close()})},toggle:function(){El.value("#conn-name")&&El.value("#conn-host")&&El.value("#conn-user")&&(Storage.has("editConnID")?this.update():this.create())},get:function(t){Storage.set("editConnID",t),ManagerConnections.open()}},TestConnection={test:function(){},message:function(t){}},topbar_loader=new TopBar(el_topbar),sidebar_loader=new SideBar(el_sidebar),menubox_loader=new MenuBox(el_menu_actions),MySQL_ListDatabases={sidebar:function(){sidebar_loader.clean(),sidebar_loader.set([{id:"list-conns",icon:"fas fa-arrow-left",title:"Back to connections",click:"ListConnections.page_load()"},{actived:!0,id:"list-databases",icon:"fas fa-database",title:"List databases's",click:"MySQL_ListDatabases.page_load()"},{id:"list-code",icon:"fas fa-code",title:"List snippets",click:"ListSnippets.page_load()"},{id:"list-diagrams",title:"List diagrams",icon:"fas fa-diagram-project",click:"Hello.world()"},{id:"list-tasks",title:"List tasks",icon:"fas fa-list-check",click:"Hello.world()"}])},databases:function(){var a=this;El.empty(el_list_content),GetConnection.create_conn().raw("SELECT * FROM information_schema.schemata ORDER BY SCHEMA_NAME ASC").then(function(e){_.forEach(e[0],function(t){a.item_layout(t),topbar_loader.total("".concat(e[0].length," databases's"))})}).catch(function(t){File.play("error.wav");var e="Error: connect ECONNREFUSED ".concat(JSON.parse(Storage.get("connData")).host,":").concat(JSON.parse(Storage.get("connData")).port);CreateBackupLogs.insert({type:"error",show_msg:!0,message:e,query:"error_connection",conn_id:JSON.parse(Storage.get("connData")).slug}),ListConnections.page_load()})},page_load:function(){this.sidebar(),this.databases(),CodeModal.layout(),topbar_loader.title(JSON.parse(Storage.get("connData")).name),menubox_loader.clean(),El.hide(el_menu_actions),El.show(el_backup_logs_btn),topbar_loader.clean(),Storage.delete("dbSelected")},item_layout:function(t){El.append(el_list_content,'\n\t\t\t<div class="item">\n\t\t\t\t<div onclick="MySQL_ListTables.go_list_tables(\''.concat(t.SCHEMA_NAME,'\')">\n\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t<div class="fas fa-database"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="mid-field">').concat(t.SCHEMA_NAME,'</div>\n\t\t\t\t\t<div class="mid-field">').concat(t.DEFAULT_COLLATION_NAME,"</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"))}},Login={_error:function(t){El.show(el_error_login),El.text(el_error_login,t),Classes.add(el_error_login,"error"),Classes.remove(el_error_login,"info"),setTimeout(function(t){El.hide(el_error_login)},3e3)},_input:function(t){return"email"==t?xss(El.value("#login-email")):"password"==t?xss(El.value("#login-password")):void 0},_return:function(t){switch(t){case"email-invalid":return this._error("Email is not valid.");case"error-login-auth-email":return this._error("The email is wrong.");case"error-login-auth-pass":return this._error("The password is wrong.");case"email-pass-required":return this._error("Email and password are required.")}},open:function(){Storage.has("userData")||(Classes.remove(el_menu_app_btn,act_class),El.hide(el_menu_app),Windows.load_custom({width:540,height:380,parent:"main",url:"pages/login.html"}))},logoff:function(){Storage.has("userData")&&(UserDB.delete(),El.hide(el_menu_app),Classes.remove(el_menu_app_btn,act_class))},connect:function(){var t,e=this;""==this._input("email")||""==this._input("password")?this._return("email-pass-required"):Validation.email(this._input("email"))?((t=new FormData).append("origin","app"),t.append("email",this._input("email")),t.append("pass",this._input("password")),fetch("".concat(Apis.core(),"login/login"),{method:"POST",body:t}).then(function(t){return t.json()}).then(function(t){"success"!=t.return||Storage.has("userData")?e._return(t.return):UserDB.insert({id:t.id,name:t.details.name,email:t.details.email,username:t.details.username,gravatar:t.details.gravatar,avatar:Core.get_file("app/cache","avatar.png")})})):this._return("email-invalid")},toggle_password:function(t){"password"==Attr.get(t,"type")?(Attr.set(t,"type","text"),Classes.change("#toggle-password","fa-eye","fa-eye-slash")):(Attr.set(t,"type","password"),Classes.change("#toggle-password","fa-eye-slash","fa-eye"))}},UserDB={get:function(){DBX.select(DBX.raw("COUNT(*) AS total")).where({name:"account"}).from("configs").then(function(t){0<t[0].total?DBX.select("value").where({name:"account"}).from("configs").then(function(t){Storage.set("userData",t[0].value),Gravatar.download()}):Storage.delete("userData")})},delete:function(){DBX.delete().from("configs").where({name:"account"}).then(function(t){Gravatar.delete(),Storage.delete("userData"),Profile.set_name_avatar()})},insert:function(e){var a=this;DBX.select(DBX.raw("COUNT(*) AS total")).where({name:"account"}).from("configs").then(function(t){0==t[0].total&&DBX.insert({name:"account",slug:Slug.range(36,48),value:JSON.stringify(e),added_in:datetime.create().format("Y-m-d H:m:S")}).into("configs").then(function(t){a.get(),Storage.set(store_force_update,"download-avatar"),Windows.custom_close()})})}},CloneTable={clone:function(){switch(El.value("#clone-options")){case"data":this.clone_data();break;case"structure":this.clone_structure();break;case"data-structure":this.clone_data_structure()}},databases:function(){El.empty("#clone-db-name"),GetConnection.create_conn().raw("SHOW DATABASES").then(function(t){_.forEach(t[0],function(t){t.Database!=Storage.get("dbSelected")&&El.append("#clone-db-name","\n\t\t\t\t\t\t<option value='".concat(t.Database,"'>").concat(t.Database,"</option>\n\t\t\t\t\t"))})})},clone_data:function(){var t=GetConnection.create_conn(),e=El.value("#clone-db-name"),a=El.value("#clone-tbl-name"),n="INSERT INTO ".concat(e,".").concat(a," SELECT * FROM ").concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw().then(function(t){CloneModal.hide(),CreateBackupLogs.insert({table:a,show_msg:!0,type:"success",database:e,query:"clone_data",sql_query:n,message:"Table data copied to ".concat(e),conn_id:JSON.parse(Storage.get("connData")).slug})})},clone_structure:function(){var t=GetConnection.create_conn(),e=El.value("#clone-db-name"),a=El.value("#clone-tbl-name"),n="CREATE TABLE ".concat(e,".").concat(a," LIKE ").concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(n).then(function(t){CloneModal.hide(),CreateBackupLogs.insert({table:a,show_msg:!0,type:"success",database:e,sql_query:n,query:"clone_structure",message:"Table structure copied to ".concat(e),conn_id:JSON.parse(Storage.get("connData")).slug})})},clone_data_structure:function(){var e=GetConnection.create_conn(),a=El.value("#clone-db-name"),n=El.value("#clone-tbl-name"),o="CREATE TABLE ".concat(a,".").concat(n," LIKE ").concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected")),l="INSERT INTO ".concat(a,".").concat(n," SELECT * FROM ").concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));e.raw(o).then(function(t){e.raw(l).then(function(t){CloneModal.hide(),CreateBackupLogs.insert({table:n,show_msg:!0,type:"success",database:a,query:"clone_data_structure",sql_query:o+"; "+l,conn_id:JSON.parse(Storage.get("connData")).slug,message:"Table data and structure copied to ".concat(a)})})})}},topbar_loader=new TopBar(el_topbar),sidebar_loader=new SideBar(el_sidebar),menubox_loader=new MenuBox(el_menu_actions),MySQL_ListCols={sidebar:function(){sidebar_loader.clean(),sidebar_loader.set([{id:"list-databases",title:"Back to tables",icon:"fas fa-arrow-left",click:"MySQL_ListTables.page_load()"},{actived:!0,id:"list-columns",title:"List columns",icon:"fas fa-table-columns",click:"MySQL_ListCols.page_load()"},{id:"view-diagram",title:"View diagram",click:"DiagramModel.show()",icon:"fas fa-project-diagram"},{id:"view-code",icon:"fas fa-code",title:"Show CREATE",click:"MySQL_TableProperties.show_create()"}])},columns:function(){El.empty(el_list_content);var t=GetConnection.create_conn();Table.clean_tbody(),Table.header(["Field","Type","Collation","Key","NULL","Default","Extra"]),t.raw("SHOW FULL COLUMNS FROM ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"))).then(function(t){_.forEach(t,function(t){_.forEach(t,function(t){var e,a,n,o;null!=t.Field&&(e=""==t.Collation||null==t.Collation?"<div class='italic'>None</div>":t.Collation,a=""==t.Key||null==t.Key?"<div class='italic'>None</div>":Str.cut(t.Key,36),n=""==t.Default||null==t.Default?"<div class='italic'>None</div>":Str.cut(t.Default,36),o=""==t.Extra||null==t.Extra?"<div class='italic no-hover'>None</div>":Str.cut(t.Extra.toUpperCase(),36),Table.add_rows([{rows:[Str.cut(t.Field,36),Str.cut(t.Type,36),e,a,t.Null,n,o]}],!0))})})}),Table.show(),topbar_loader.total("".concat(Storage.get("tblSelectedRows")," Row's"))},page_load:function(){this.sidebar(),this.columns(),this.menu_actions(),CloneModal.layout(),DiagramModel.layout(),CreateDiagram.create(),CloneTable.databases(),topbar_loader.title(Storage.get("tblSelected")),topbar_loader.clean(),topbar_loader.append("\n\t\t\t<div class='fa-solid fa-bars' id='menu-manager' title='Manager' onclick='menubox_loader.toggle()'></div>\n\t\t"),menubox_loader.hide()},menu_actions:function(){menubox_loader.clean(),menubox_loader.set([{text:"Rename",id:"rename-tbl",click:"ConfirmModalTable.rename_table()"},{text:"Check",id:"check-tbl",click:"MySQL_TableProperties.check()"},{text:"Analyze",id:"analyze-tbl",click:"MySQL_TableProperties.analyze()"},{text:"Repair",id:"repair-tbl",click:"MySQL_TableProperties.repair()"},{text:"Optimize",id:"optimize-tbl",click:"MySQL_TableProperties.optimize()"},{text:"Clone",id:"clone-tbl",click:"CloneModal.show()"},{text:"Truncate",id:"truncate-tbl",click:"ConfirmModalTable.truncate_table()"},{text:"Drop",id:"drop-tbl",click:"ConfirmModalTable.drop_table()"}])},go_list_cols:function(t,e){Storage.set("tblSelected",t),Storage.set("tblSelectedRows",Format.number(e)),this.page_load()}},topbar_loader=new TopBar(el_topbar),sidebar_loader=new SideBar(el_sidebar),menubox_loader=new MenuBox(el_menu_actions),MySQL_ListTables={tables:function(){var a=this,n=(El.empty(el_list_content),GetConnection.create_conn());n.raw("SELECT table_name, table_collation, engine, ROUND((data_length + index_length)) AS 'size', create_time FROM information_schema.tables WHERE table_schema = '".concat(Storage.get("dbSelected"),"' ORDER BY table_name ASC")).then(function(t){0<t[0].length?_.forEach(t[0],function(e){n.raw("SELECT COUNT(*) AS 'rows' FROM "+Storage.get("dbSelected")+"."+e.table_name).then(function(t){t[0].forEach(function(t){a.item_layout(e,t.rows)})})}):(topbar_loader.clean(),El.append(el_list_content,'\n\t\t\t\t\t<div class="zero">Database is empty</div>\n\t\t\t\t')),topbar_loader.total("".concat(t[0].length," table's"))})},sidebar:function(){sidebar_loader.clean(),sidebar_loader.set([{id:"list-databases",icon:"fas fa-arrow-left",title:"Back to databases",click:"MySQL_ListDatabases.page_load()"},{actived:!0,id:"list-tables",icon:"fas fa-table",title:"List tables's",click:"MySQL_ListTables.page_load()"},{id:"list-backups",icon:"fas fa-file",title:"List backup's",click:"ListBackups.page_load()"}])},page_load:function(){topbar_loader.clean(),topbar_loader.append("\n\t\t\t<div class='fa-solid fa-file-export' onclick='BackupModal.show()' title='Create backup'></div>\n\t\t"),Table.hide(),Table.clean_table(),El.hide(el_menu_actions),this.tables(),this.sidebar(),BackupModal.layout(),topbar_loader.title(Storage.get("dbSelected")),Storage.delete("tblSelected")},go_list_tables:function(t){Storage.set("dbSelected",t),this.page_load()},item_layout:function(t,e){El.append(el_list_content,'\n\t\t\t<div class="item">\n\t\t\t\t<div onclick="MySQL_ListCols.go_list_cols(\''.concat(t.table_name,"', '").concat(e,'\')">\n\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t<div class="fas fa-table"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="field1">').concat(Str.cut(t.table_name,40),'</div>\n\t\t\t\t\t<div class="field2">').concat(Str.cut(t.table_collation,24),'</div>\n\t\t\t\t\t<div class="field3">').concat(Str.cut(t.engine,24),'</div>\n\t\t\t\t\t<div class="field4">').concat(Format.bytes(t.size),'</div>\n\t\t\t\t\t<div class="field5">').concat(Format.number(e)," Row's</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"))}},menubox_loader=new MenuBox(el_menu_actions),MySQL_TableProperties={drop:function(){var t=GetConnection.create_conn(),e="DROP TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!1,type:"success",query:"drop_table",sql_query:e,table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}),ConfirmModal.hide(),MySQL_ListTables.page_load()})},check:function(){menubox_loader.toggle();var t=GetConnection.create_conn(),e="CHECK TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!0,type:"success",sql_query:e,query:"check_table",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),message:"Check: ".concat(t[0][0].Msg_text),conn_id:JSON.parse(Storage.get("connData")).slug})})},repair:function(){menubox_loader.toggle();var t=GetConnection.create_conn(),e="REPAIR TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!0,type:"success",sql_query:e,query:"repair_table",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),message:"Repair: ".concat(t[0][0].Msg_text),conn_id:JSON.parse(Storage.get("connData")).slug})})},rename:function(){var t,e,a=El.value("#rename-input-modal");""!=a&&(t=GetConnection.create_conn(),e="RENAME TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected")," TO ").concat(Storage.get("dbSelected"),".").concat(a),t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!1,type:"success",sql_query:e,query:"rename_table",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug,message:"Rename table from ".concat(Storage.get("tblSelected")," to ").concat(a)}),Storage.set("tblSelected",a),MySQL_ListCols.page_load(),ConfirmModal.hide()}))},analyze:function(){menubox_loader.toggle();var t=GetConnection.create_conn(),e="ANALYZE TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!0,type:"success",sql_query:e,query:"analyze_table",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),message:"Analyze: ".concat(t[0][0].Msg_text),conn_id:JSON.parse(Storage.get("connData")).slug})})},optimize:function(){menubox_loader.toggle();var t=GetConnection.create_conn(),e="OPTIMIZE TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!0,type:"success",sql_query:e,query:"optmize_table",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),message:"Optimize: ".concat(t[0][0].Msg_text),conn_id:JSON.parse(Storage.get("connData")).slug})})},truncate:function(){var t=GetConnection.create_conn(),e="TRUNCATE TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!0,type:"success",sql_query:e,query:"truncate_table",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug,message:"Truncate: The table ".concat(Storage.get("tblSelected")," was truncated")}),ConfirmModal.hide(),Storage.set("tblSelectedRows","0"),topbar_loader.total("".concat(Storage.get("tblSelectedRows")," Row's"))})},show_create:function(){var t=GetConnection.create_conn(),e="SHOW CREATE TABLE ".concat(Storage.get("dbSelected"),".").concat(Storage.get("tblSelected"));t.raw(e).then(function(t){CreateBackupLogs.insert({show_msg:!1,type:"success",sql_query:e,query:"show_create",table:Storage.get("tblSelected"),database:Storage.get("dbSelected"),conn_id:JSON.parse(Storage.get("connData")).slug}),CodeModal.title(t[0][0].Table),EditorAutoload.setValue(t[0][0]["Create Table"]),CodeModal.show(),CodeModal.show_save()})}};