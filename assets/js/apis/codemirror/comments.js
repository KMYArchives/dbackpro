!function(e){"object"==typeof exports&&"object"==typeof module?e(require("codemirror")):"function"==typeof define&&define.amd?define(["codemirror"],e):e(CodeMirror)}(function(e){"use strict";var M={},R=/[^\s\u00a0]/,E=e.Pos;function g(e){var n=e.search(R);return-1==n?0:n}function S(e,n){var t=e.getMode();return!1!==t.useInnerComments&&t.innerMode?e.getModeAt(n):t}e.commands.toggleComment=function(e){e.toggleComment()},e.defineExtension("toggleComment",function(e){e=e||M;for(var n=this,t=1/0,i=this.listSelections(),o=null,l=i.length-1;0<=l;l--){var r=i[l].from(),c=i[l].to();r.line>=t||(c.line>=t&&(c=E(t,0)),t=r.line,null==o?o=n.uncomment(r,c,e)?"un":(n.lineComment(r,c,e),"line"):"un"==o?n.uncomment(r,c,e):n.lineComment(r,c,e))}}),e.defineExtension("lineComment",function(l,e,r){r=r||M;var n,c,m,a,f,s=this,t=S(s,l),i=s.getLine(l.line);null!=i&&(n=i,!/\bstring\b/.test(s.getTokenTypeAt(E(l.line,0)))||/^[\'\"\`]/.test(n))&&((c=r.lineComment||t.lineComment)?(m=Math.min(0!=e.ch||e.line==l.line?e.line+1:e.line,s.lastLine()+1),a=null==r.padding?" ":r.padding,f=r.commentBlankLines||l.line==e.line,s.operation(function(){if(r.indent){for(var e=null,n=l.line;n<m;++n){var t=(i=s.getLine(n)).slice(0,g(i));(null==e||e.length>t.length)&&(e=t)}for(n=l.line;n<m;++n){var i=s.getLine(n),o=e.length;(f||R.test(i))&&(i.slice(0,o)!=e&&(o=g(i)),s.replaceRange(e+c+a,E(n,0),E(n,o)))}}else for(n=l.line;n<m;++n)(f||R.test(s.getLine(n)))&&s.replaceRange(c+a,E(n,0))})):(r.blockCommentStart||t.blockCommentStart)&&(r.fullLines=!0,s.blockComment(l,e,r)))}),e.defineExtension("blockComment",function(i,o,l){l=l||M;var r,c,m=this,a=S(m,i),f=l.blockCommentStart||a.blockCommentStart,s=l.blockCommentEnd||a.blockCommentEnd;f&&s?/\bcomment\b/.test(m.getTokenTypeAt(E(i.line,0)))||((r=Math.min(o.line,m.lastLine()))!=i.line&&0==o.ch&&R.test(m.getLine(r))&&--r,c=null==l.padding?" ":l.padding,i.line>r||m.operation(function(){if(0!=l.fullLines){var e=R.test(m.getLine(r));m.replaceRange(c+s,E(r)),m.replaceRange(f+c,E(i.line,0));var n=l.blockCommentLead||a.blockCommentLead;if(null!=n)for(var t=i.line+1;t<=r;++t)t==r&&!e||m.replaceRange(n+c,E(t,0))}else m.replaceRange(s,o),m.replaceRange(f,i)})):(l.lineComment||a.lineComment)&&0!=l.fullLines&&m.lineComment(i,o,l)}),e.defineExtension("uncomment",function(e,n,t){t=t||M;var o,l=this,i=S(l,e),r=Math.min(0!=n.ch||n.line==e.line?n.line:n.line-1,l.lastLine()),c=Math.min(e.line,r),m=t.lineComment||i.lineComment,a=[],f=null==t.padding?" ":t.padding;e:if(m){for(var s=c;s<=r;++s){var g=l.getLine(s),u=g.indexOf(m);if(-1<u&&!/comment/.test(l.getTokenTypeAt(E(s,u+1)))&&(u=-1),-1==u&&R.test(g))break e;if(-1<u&&R.test(g.slice(0,u)))break e;a.push(g)}if(l.operation(function(){for(var e=c;e<=r;++e){var n=a[e-c],t=n.indexOf(m),i=t+m.length;t<0||(n.slice(i,i+f.length)==f&&(i+=f.length),o=!0,l.replaceRange("",E(e,t),E(e,i)))}}),o)return!0}var d=t.blockCommentStart||i.blockCommentStart,h=t.blockCommentEnd||i.blockCommentEnd;if(!d||!h)return!1;var p=t.blockCommentLead||i.blockCommentLead,C=l.getLine(c),b=C.indexOf(d);if(-1==b)return!1;var k=r==c?C:l.getLine(r),v=k.indexOf(h,r==c?b+d.length:0),x=E(c,b+1),L=E(r,v+1);if(-1==v||!/comment/.test(l.getTokenTypeAt(x))||!/comment/.test(l.getTokenTypeAt(L))||-1<l.getRange(x,L,"\n").indexOf(h))return!1;var y=-1==(T=C.lastIndexOf(d,e.ch))?-1:C.slice(0,e.ch).indexOf(h,T+d.length);if(-1!=T&&-1!=y&&y+h.length!=e.ch)return!1;y=k.indexOf(h,n.ch);var O=k.slice(n.ch).lastIndexOf(d,y-n.ch),T=-1==y||-1==O?-1:n.ch+O;return(-1==y||-1==T||T==n.ch)&&(l.operation(function(){l.replaceRange("",E(r,v-(f&&k.slice(v-f.length,v)==f?f.length:0)),E(r,v+h.length));var e=b+d.length;if(f&&C.slice(e,e+f.length)==f&&(e+=f.length),l.replaceRange("",E(c,b),E(c,e)),p)for(var n=c+1;n<=r;++n){var t,i=l.getLine(n),o=i.indexOf(p);-1==o||R.test(i.slice(0,o))||(t=o+p.length,f&&i.slice(t,t+f.length)==f&&(t+=f.length),l.replaceRange("",E(n,o),E(n,t)))}}),!0)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("codemirror")):"function"==typeof define&&define.amd?define(["codemirror"],e):e(CodeMirror)}(function(b){var i=/\S/g,k=String.prototype.repeat||function(e){return Array(e+1).join(this)};function l(n){if(n.getOption("disableInput"))return b.Pass;for(var e,t,i=n.listSelections(),o=[],l=0;l<i.length;l++){var r=i[l].head;if(!/\bcomment\b/.test(n.getTokenTypeAt(r)))return b.Pass;var c=n.getModeAt(r);if(e){if(e!=c)return b.Pass}else e=c;var m,a,f,s,g,u,d,h=null,p=e.blockCommentStart,C=e.lineComment;if(p&&e.blockCommentContinue&&(-1!=(a=(m=n.getLine(r.line)).lastIndexOf(e.blockCommentEnd,r.ch-e.blockCommentEnd.length))&&a==r.ch-e.blockCommentEnd.length||C&&-1<(g=m.lastIndexOf(C,r.ch-1))&&/\bcomment\b/.test(n.getTokenTypeAt({line:r.line,ch:g+1}))||(r.ch>=p.length&&-1<(g=m.lastIndexOf(p,r.ch-p.length))&&a<g?h=v(0,m)>=g?m.slice(0,g):(f=n.options.tabSize,g=b.countColumn(m,g,f),n.options.indentWithTabs?k.call("\t",s=Math.floor(g/f))+k.call(" ",g-f*s):k.call(" ",g)):-1<(g=m.indexOf(e.blockCommentContinue))&&g<=r.ch&&g<=v(0,m)&&(h=m.slice(0,g))),null!=h&&(h+=e.blockCommentContinue)),null==h&&C&&(!(t=n.getOption("continueComments"))||"object"!=typeof t||!1!==t.continueLineComment)&&(null==m&&(m=n.getLine(r.line)),g=m.indexOf(C),r.ch||g?-1<g&&v(0,m)>=g&&((h=-1<v(r.ch,m))||(h=-1<(d=(u=n.getLine(r.line+1)||"").indexOf(C))&&v(0,u)>=d||null),h=h&&m.slice(0,g)+C+m.slice(g+C.length).match(/^\s*/)[0]):h=""),null==h)return b.Pass;o[l]="\n"+h}n.operation(function(){for(var e=i.length-1;0<=e;e--)n.replaceRange(o[e],i[e].from(),i[e].to(),"+insert")})}function v(e,n){i.lastIndex=e;var t=i.exec(n);return t?t.index:-1}b.defineOption("continueComments",null,function(e,n,t){var i,o;t&&t!=b.Init&&e.removeKeyMap("continueComment"),n&&(i="Enter","string"==typeof n?i=n:"object"==typeof n&&n.key&&(i=n.key),(o={name:"continueComment"})[i]=l,e.addKeyMap(o))})});